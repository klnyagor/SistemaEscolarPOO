package Telas;

import Controller.MenuPrincipalController;
import Model.Repositorio.UsuarioDAO;
import Model.Usuario;
import javax.swing.JOptionPane;

/**
 *
 * @author Wedson
 * @author Yagor
 */
public class UsuarioView extends javax.swing.JPanel {
    private final MenuPrincipalController controller;
    private final MenuPrincipal menu;
    private Usuario usuario;

    /**
     * Creates new form UsuarioView
     */
    public UsuarioView(MenuPrincipal menu, Usuario usuario) {
        initComponents();
        this.menu = menu;
        controller = menu.getController();
        this.usuario = usuario;
        UsuarioLoginInput.setText(usuario.getUsuario());
        UsuarioLoginInput.setEditable(false);
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        Header = new javax.swing.JPanel();
        usuarioLabel = new javax.swing.JLabel();
        Main = new javax.swing.JPanel();
        jLabel2 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        UsuarioLoginInput = new javax.swing.JTextField();
        UsuarioPasswordInput = new javax.swing.JPasswordField();
        Footer = new javax.swing.JPanel();
        btnAlterarSenha = new javax.swing.JButton();
        btnDeletarUser = new javax.swing.JButton();

        setOpaque(false);
        setLayout(new javax.swing.BoxLayout(this, javax.swing.BoxLayout.PAGE_AXIS));

        Header.setOpaque(false);

        usuarioLabel.setFont(new java.awt.Font("Arial", 1, 24)); // NOI18N
        usuarioLabel.setForeground(new java.awt.Color(255, 255, 255));
        usuarioLabel.setText("Meu Usuario");

        javax.swing.GroupLayout HeaderLayout = new javax.swing.GroupLayout(Header);
        Header.setLayout(HeaderLayout);
        HeaderLayout.setHorizontalGroup(
            HeaderLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(HeaderLayout.createSequentialGroup()
                .addGap(69, 69, 69)
                .addComponent(usuarioLabel)
                .addContainerGap(386, Short.MAX_VALUE))
        );
        HeaderLayout.setVerticalGroup(
            HeaderLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(HeaderLayout.createSequentialGroup()
                .addGap(25, 25, 25)
                .addComponent(usuarioLabel)
                .addGap(25, 25, 25))
        );

        add(Header);

        jLabel2.setFont(new java.awt.Font("Arial Black", 0, 14)); // NOI18N
        jLabel2.setText("Login:");

        jLabel3.setFont(new java.awt.Font("Arial Black", 0, 14)); // NOI18N
        jLabel3.setText("Nova Senha:");

        UsuarioLoginInput.setFont(new java.awt.Font("Arial", 0, 14)); // NOI18N
        UsuarioLoginInput.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                UsuarioLoginInputActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout MainLayout = new javax.swing.GroupLayout(Main);
        Main.setLayout(MainLayout);
        MainLayout.setHorizontalGroup(
            MainLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, MainLayout.createSequentialGroup()
                .addContainerGap(142, Short.MAX_VALUE)
                .addGroup(MainLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel3)
                    .addComponent(jLabel2))
                .addGap(18, 18, 18)
                .addGroup(MainLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(UsuarioLoginInput)
                    .addComponent(UsuarioPasswordInput, javax.swing.GroupLayout.PREFERRED_SIZE, 215, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(130, 130, 130))
        );
        MainLayout.setVerticalGroup(
            MainLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(MainLayout.createSequentialGroup()
                .addGap(65, 65, 65)
                .addGroup(MainLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel2)
                    .addComponent(UsuarioLoginInput, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(MainLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel3)
                    .addComponent(UsuarioPasswordInput, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(64, Short.MAX_VALUE))
        );

        add(Main);

        Footer.setOpaque(false);

        btnAlterarSenha.setFont(new java.awt.Font("Arial", 1, 14)); // NOI18N
        btnAlterarSenha.setText("Alterar Senha");
        btnAlterarSenha.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnAlterarSenhaActionPerformed(evt);
            }
        });

        btnDeletarUser.setFont(new java.awt.Font("Arial", 1, 14)); // NOI18N
        btnDeletarUser.setText("Excluir Conta");
        btnDeletarUser.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnDeletarUserActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout FooterLayout = new javax.swing.GroupLayout(Footer);
        Footer.setLayout(FooterLayout);
        FooterLayout.setHorizontalGroup(
            FooterLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, FooterLayout.createSequentialGroup()
                .addGap(48, 48, 48)
                .addComponent(btnDeletarUser)
                .addGap(166, 166, 166)
                .addComponent(btnAlterarSenha)
                .addContainerGap(130, Short.MAX_VALUE))
        );
        FooterLayout.setVerticalGroup(
            FooterLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(FooterLayout.createSequentialGroup()
                .addGap(35, 35, 35)
                .addGroup(FooterLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnAlterarSenha)
                    .addComponent(btnDeletarUser))
                .addContainerGap(88, Short.MAX_VALUE))
        );

        add(Footer);
    }// </editor-fold>//GEN-END:initComponents

    private void UsuarioLoginInputActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_UsuarioLoginInputActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_UsuarioLoginInputActionPerformed

    private void btnAlterarSenhaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnAlterarSenhaActionPerformed
        String msg = "Ops, algo de errado não está certo..";
        try{
            String login = UsuarioLoginInput.getText();
            String novaSenha = UsuarioPasswordInput.getText();
            UsuarioDAO user = new UsuarioDAO();
            if(user.update(login, novaSenha)){
                this.usuario = new Usuario(login, novaSenha);
                msg = "Senha alterada!";
            }            
        } catch (Exception e){
            e.printStackTrace();
        } finally{
            JOptionPane.showMessageDialog(null,msg);
        }
    }//GEN-LAST:event_btnAlterarSenhaActionPerformed

    private void btnDeletarUserActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnDeletarUserActionPerformed
        UsuarioDAO user = new UsuarioDAO();
        if(user.delete(usuario)){
            JOptionPane.showMessageDialog(null, "Usuario deletado!");
            Login login = new Login();
            login.setVisible(true);
            menu.dispose();
        }
    }//GEN-LAST:event_btnDeletarUserActionPerformed


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JPanel Footer;
    private javax.swing.JPanel Header;
    private javax.swing.JPanel Main;
    private javax.swing.JTextField UsuarioLoginInput;
    private javax.swing.JPasswordField UsuarioPasswordInput;
    private javax.swing.JButton btnAlterarSenha;
    private javax.swing.JButton btnDeletarUser;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel usuarioLabel;
    // End of variables declaration//GEN-END:variables
}
